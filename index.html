<!DOCTYPE html>
<html>
	<head>
		<title>Cross Youtube Downloader</title>
		<script src="js/jquery-2.1.0.min.js"></script>
		<script>
		var fs = require('fs');
		var db = openDatabase('app-db', '1.0', 'Cross platform YouTube downloader database.', 2 * 1024 * 1024);

		Column = function(name, type, notNull, autoincrement, primary, unique) {
			this.Name 			= name;
			this.Type 			= type;
			this.NotNull 		= notNull;
			this.AutoIncrement 	= autoincrement;
			this.Primary 		= primary;
			this.Unique 		= unique;

			this.getSQL = function() {
				sql = '`' + this.Name + '` ' + this.Type;
				sql += this.NotNull || ' NOT NULL';
				sql += this.AutoIncrement || ' AUTOINCREMENT';
				sql += this.Primary || ' PRIMARY KEY';
				sql += this.Unique || ' UNIQUE';
				return sql;
			}
		}

		TableSchema = function(name) {
			name = name;
			columns = [];

			this.addColumn = function(column) {
				columns.push(column);
			}
		}

		ConfigKey = function(name, defaultValue) {
			this.Name = name;
			this.DefaultValue = defaultValue;
			this.Value = defaultValue;
		}

		Config = function() {
			keys = [new ConfigKey('downloadPath', '/this/is/download/path'),
				new ConfigKey('language', 'en')];

			// Column::__construct params: name, type, notNull, autoincrement, primary, unique
			columns = [new Column('Id', 'INTEGER', false, true, true, false),
				new Column('Key', 'TEXT', true, false, false, true),
				new Column('Value', 'TEXT', false, false, false, false)];

			this.getCreateTableSQL = function() {
				return 'CREATE TABLE IF NOT EXISTS `config` (`Id` INTEGER PRIMARY KEY AUTOINCREMENT, `Key` TEXT UNIQUE NOT NULL, `Value` TEXT)';
			}
		}

		db.transaction(function(tx) {
			tx.executeSql('CREATE TABLE IF NOT EXISTS `config` (`Id` INTEGER PRIMARY KEY AUTOINCREMENT, `Key` TEXT UNIQUE NOT NULL, `Value` TEXT)');
			tx.executeSql('INSERT INTO `config` (`Key`, `Value`) VALUES ("downloadPath", "/this/is/download/path")');
			tx.executeSql('INSERT INTO `config` (`Key`, `Value`) VALUES ("language", "en")');
		});

		db.transaction(function(tx) {
			tx.executeSql('SELECT * FROM `config`', [], function(tx, result) {
				len = result.rows.length;
				for(var i = 0; i < len; i++) {
					console.log(result.rows.item(i));
				}
			});
		});

		fs.readdir('.', function(err, files) {
			$.each(files, function(index, item) {
				$('.projects').append('<li>' + item + '</li>');
			});
		});
		</script>
	</head>
	<body>
		<h1>Cross Youtube Downloader</h1>
		We are using node.js <script>document.write(process.version)</script>.<br/>
		Files in directory:<br/>
		<ul class="projects">
		</ul>
		<br/>
		<button class="dropTBL">Drop Table</button>
		<script>
		$('.dropTBL').click(function() {
			db.transaction(function(tx) {
				tx.executeSql('DROP TABLE `config`;');
				alert('Table `config` dropped.');
			});
			
		});
		</script>
	</body>
</html>